<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Romano Clayton — Men's & Women's Clothing</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:400,500&display=swap" rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    body { font-family: 'Roboto', Arial, sans-serif; background:#f3f6fa; margin:0; }
    header { background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.08); padding:22px 30px; position:sticky; top:0; z-index:5; }
    .logo {font-family: 'Montserrat', Arial, sans-serif; font-size:2rem; font-weight:700; letter-spacing:2px;}
    nav a { margin-left:28px; text-decoration:none; color:#222; font-weight:500; font-size:1rem;}
    nav a:hover { color:#0099cc; }
    .hero { background:url('https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;
      height:320px; display:flex; align-items:center; justify-content:center; color:#fff; text-shadow:0 2px 12px rgba(0,0,0,0.3); font-size:2.2rem; font-weight:700; letter-spacing:1.5px;}
    .container { max-width:1140px; margin:auto; padding:24px;}
    .section-title { font-size:1.45rem; margin:36px 0 18px 0; font-weight:700;}
    .products {display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:26px;}
    .card {background:#fff; border-radius:13px; box-shadow:0 2px 8px rgba(0,0,0,0.10); padding:15px;}
    .card img { width:100%; height:265px; object-fit:cover; border-radius:10px;}
    .card-title { font-size:1.08rem; margin:10px 0 4px; font-weight:600;}
    .card-price { color:#333; font-weight:700; margin-bottom:6px; }
    .card .gender { font-size:14px; color: #0099cc; margin-bottom:8px;}
    .card button { padding:11px 18px; background:#0099cc; color:#fff; border:0; border-radius:9px; cursor:pointer; box-shadow:0 2px 4px #0099cc55; transition:.1s;}
    .card button:hover {background:#007ab8;}
    .cart {
      position:fixed; right:28px; bottom:28px;
      width:335px; background:#fff; padding:19px; border-radius:14px;
      box-shadow:0 10px 32px rgba(0,0,0,0.17); display:none; z-index:1004; border: 1px solid #e3e7ee;
    }
    .cart h3 {margin:0 0 12px;font-size:1.15rem;}
    .cart-total {font-size:1.15rem;font-weight:700; margin-top:8px;}
    .cart-empty {color:#999;}
    .suppliers { background:#191a1c; color:#fff; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.16); margin-top:32px; padding:24px;}
    .supplier-list {display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:14px;}
    .supplier-card { background:#26282b; border-radius:9px; margin-bottom:8px; padding:12px 15px;}
    .supplier-card a { color:#40c2ff; font-weight:500;}
    .supplier-card a:hover{color:#77defa;}
    .category-label {color:#ffeb3b;font-size:13px;letter-spacing:0.5px;}
    footer { background:#1c2027; color:#fff; text-align:center; padding:20px; margin-top:44px; font-size:15px; }
    @media(max-width: 700px) {
      .container {padding:10px;}
      .cart {right:4px; width:99vw;}
      .products {grid-template-columns: 1fr;}
      .supplier-list {grid-template-columns: 1fr;}
    }
    .stripe-card-el {margin:10px 0 19px 0;}
  </style>
</head>
<body>
<header>
  <div style="display:flex; align-items:center; justify-content:space-between;">
    <div class="logo">Romano Clayton</div>
    <nav>
      <a href="#products">Shop</a>
      <a href="#suppliers">Suppliers</a>
    </nav>
  </div>
</header>
<div class="hero">
  Quality Men's & Women's Clothing
</div>
<div class="container">

  <div class="section-title" id="products">Featured Clothing</div>
  <div class="products" id="products-list"></div>

  <div class="section-title" id="suppliers">Quality Suppliers</div>
  <div class="suppliers">
    <div class="supplier-list" id="supplier-list"></div>
    <div style="font-size:14px; margin-top:20px;">All suppliers offer men's and women's fashion at wholesale prices. Contact for catalogues and pricing.</div>
  </div>
</div>

<div class="cart" id="cart">
  <h3>Your Cart</h3>
  <div id="cart-items"></div>
  <div class="cart-total">Total: R<span id="total">0</span></div>
  <button onclick="openCheckout()">Checkout</button>
</div>

<!-- Checkout Modal -->
<div id="checkoutModal" style="display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);
background:white;padding:28px;border-radius:13px;width:95vw;max-width:420px;box-shadow:0 20px 46px rgba(0,0,0,0.24);z-index:99999;">
  <h3 style="margin-top:0">Checkout</h3>
  <input id="name" placeholder="Full Name" style="width:100%;padding:10px;margin:8px 0;">
  <input id="email" placeholder="Email" style="width:100%;padding:10px;margin:8px 0;">
  <input id="address" placeholder="Address" style="width:100%;padding:10px;margin:8px 0;">
  <label style="margin-top:16px;font-weight:500;">Card Details</label>
  <div id="stripe-card-element" class="stripe-card-el"></div>
  <div id="card-errors" style="color:#e00;font-size:14px;margin-top:5px;"></div>
  <button onclick="completeOrder()">Place Order</button>
  <button onclick="closeCheckout()" style="background:#474849;margin-top:12px;">Cancel</button>
</div>
<footer>
  © 2025 Romano Clayton — Men's & Women's Everyday Apparel
</footer>
<script>
const API_BASE = 'http://localhost:4000/api';
let PRODUCTS = [];
let SUPPLIERS = [];
let cart = {};

async function fetchProducts() {
  const res = await fetch(API_BASE + '/products');
  PRODUCTS = await res.json();
  renderProducts();
}
async function fetchSuppliers() {
  const res = await fetch(API_BASE + '/suppliers');
  SUPPLIERS = await res.json();
  renderSuppliers();
}
function renderProducts() {
  const el = document.getElementById("products-list");
  el.innerHTML = "";
  PRODUCTS.forEach(product => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <img src="${product.img}">
      <div class="card-title">${product.name}</div>
      <div class="card-price">R${product.price}</div>
      <div class="gender">${product.gender}</div>
      <button onclick="addToCart(${product.id})">Add to Cart</button>
    `;
    el.appendChild(div);
  });
}
function renderSuppliers() {
  const el = document.getElementById("supplier-list");
  el.innerHTML = "";
  SUPPLIERS.forEach(supplier => {
    el.innerHTML += `<div class="supplier-card">
      <strong>${supplier.name}</strong><br>
      <a href="${supplier.website}" target="_blank">${supplier.website}</a><br>
      <span class="category-label">${supplier.category}</span><br>
      <span style="font-size:14px;color:#aad;letter-spacing:0.2px;">Contact: ${supplier.contact}</span>
    </div>`;
  });
}
function addToCart(id) {
  cart[id] = (cart[id] || 0) + 1;
  updateCart();
}
function updateCart() {
  const cartEl = document.getElementById("cart");
  cartEl.style.display = Object.keys(cart).length ? "block" : "none";
  const items = document.getElementById("cart-items");
  let html = "", total = 0;
  for (let id in cart) {
    const product = PRODUCTS.find(p => p.id == id);
    const qty = cart[id];
    html += `<div>${product.name} x ${qty} — R${product.price * qty}</div>`;
    total += product.price * qty;
  }
  items.innerHTML = html || '<span class="cart-empty">Cart is empty.</span>';
  document.getElementById("total").innerText = total;
}
function openCheckout() {
  document.getElementById("checkoutModal").style.display = "block";
}
let stripe_public_key = "pk_test_YourStripePublicKey"; // <-- REPLACE with your Stripe public key!
let stripe = Stripe(stripe_public_key);
let stripeCard = null;
let stripeElements = null;

function setupStripe() {
  stripeElements = stripe.elements();
  stripeCard = stripeElements.create('card', { hidePostalCode: true });
  stripeCard.mount("#stripe-card-element");
  stripeCard.on('change', function(event) {
    document.getElementById('card-errors').innerText = event.error ? event.error.message : '';
  });
}
function closeCheckout() {
  document.getElementById("checkoutModal").style.display = "none";
}
async function completeOrder() {
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const address = document.getElementById('address').value;
  if(!name || !email || !address) return alert("Fill all fields!");
  const orderItems = Object.entries(cart).map(([id, qty]) => ({
    productId: parseInt(id),
    qty: qty
  }));
  let {token, error} = await stripe.createToken(stripeCard, {name});
  if (error) {
    document.getElementById('card-errors').innerText = error.message;
    return;
  }
  // Send order to backend
  const res = await fetch(API_BASE + '/order', {
    method: 'POST',
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      cart: orderItems, name, email, address, token: token.id
    })
  });
  const data = await res.json();
  if(data.success){
    alert("Order placed! Payment ID: "+data.orderId);
    cart = {};
    updateCart();
    closeCheckout();
  }else{
    document.getElementById('card-errors').innerText = data.msg || "Order failed!";
  }
}
fetchProducts();
fetchSuppliers();
window.onload = setupStripe;
</script>
</body>
</html>
